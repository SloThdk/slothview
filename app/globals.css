@import "tailwindcss";

:root {
  --bg: #08080C;
  --bg-panel: rgba(10,10,14,0.98);
  --accent: #6C63FF;
  --accent-glow: rgba(108,99,255,0.12);
  --text: #EEEEF0;
  --text-dim: rgba(238,238,240,0.35);
  --border: rgba(255,255,255,0.04);
}

* { margin: 0; padding: 0; box-sizing: border-box; }
html, body { background: var(--bg); color: var(--text); font-family: 'Inter', system-ui, -apple-system, sans-serif; overflow: hidden; max-width: 100vw; width: 100%; height: 100dvh; overscroll-behavior: none; -webkit-overflow-scrolling: touch; position: fixed; inset: 0; }
button { cursor: pointer; border: none; background: none; color: inherit; font: inherit; }
/* Hide number input spinners globally */
input[type=number] { -moz-appearance: textfield; }
input[type=number]::-webkit-outer-spin-button,
input[type=number]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
input, select { font: inherit; }

::-webkit-scrollbar { width: 3px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); border-radius: 3px; }

.leva-container { display: none !important; }

@keyframes fadeIn { from { opacity: 0; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }
/* Toast: animation owns the full transform (X centering + Y slide) so they never conflict */
@keyframes toastPop {
  from { opacity: 0; transform: translateX(-50%) translateY(8px); }
  to   { opacity: 1; transform: translateX(-50%) translateY(0);   }
}
.toast-msg { animation: toastPop 0.18s ease-out forwards; }
@keyframes fadeInOverlay { from { opacity: 0; } to { opacity: 1; } }
@keyframes fadeInStrip { from { opacity: 0; transform: scaleY(0.96); } to { opacity: 1; transform: scaleY(1); } }
@keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }
@keyframes slideUp { from { opacity: 0; transform: translateY(100%); } to { opacity: 1; transform: translateY(0); } }

/* Prevent any horizontal scroll on iOS */
#__next, main { overflow: hidden !important; max-width: 100vw !important; }

/* ── Desktop defaults ── */
.burger-btn { display: none !important; }
.desktop-edge-tab { display: flex; }
.mobile-model-bar { display: none !important; }
.mobile-nav-hint { display: none !important; }
.mobile-fab { display: none !important; }
.nav-hint { display: flex !important; }
.sidebar-backdrop { display: none !important; }
.badge-hint { display: inline !important; }

/* ── Mobile & tablet (up to 768px) ── */
@media (max-width: 768px) {
  /* Sidebar — slides in from left as sheet */
  .desktop-edge-tab { display: none !important; }
  .sidebar-panel {
    position: fixed !important;
    left: 0 !important;
    top: 32px !important;
    bottom: 0 !important;
    z-index: 40 !important;
    width: 78vw !important;
    max-width: 290px !important;
    animation: slideIn 0.2s ease;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
  }
  .sidebar-panel[data-closed="true"] {
    transform: translateX(-100%) !important;
    pointer-events: none !important;
    opacity: 0 !important;
    width: 0 !important;
  }
  /* overflow: visible so sidebar-panel sees all content height and can scroll it */
  .sidebar-panel > div { min-width: 0 !important; overflow: visible !important; }
  .sidebar-panel * { max-width: 100% !important; box-sizing: border-box !important; }
  /* Single scroll container on mobile — sidebar-panel owns all scrolling.
     sidebar-content must NOT independently scroll or you get snap-back jank. */
  .sidebar-content { overflow-y: visible !important; overflow-x: visible !important; }
  /* Touch-friendly tap targets */
  .sidebar-panel button { min-height: 38px; }
  .sidebar-panel input[type="range"] { height: 6px !important; touch-action: pan-x; }
  .sidebar-panel input[type="range"]::-webkit-slider-thumb { width: 18px !important; height: 18px !important; }
  .sidebar-panel input[type="range"]::-moz-range-thumb { width: 18px !important; height: 18px !important; }
  .sidebar-backdrop { display: block !important; }

  /* Burger / nav switches */
  .burger-btn { display: flex !important; position: fixed !important; z-index: 55 !important; top: 42px !important; left: 8px !important; }
  .nav-hint { display: none !important; }
  .mobile-nav-hint { display: flex !important; }

  /* Bottom toolbar — shrink and keep centered */
  .viewport-toolbar {
    bottom: 6px !important;
    padding: 3px 4px !important;
    border-radius: 8px !important;
    max-width: calc(100vw - 16px) !important;
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    gap: 2px !important;
  }
  .viewport-toolbar button {
    padding: 5px 8px !important;
    font-size: 10px !important;
    min-height: 32px !important;
  }
  .viewport-toolbar svg { width: 13px !important; height: 13px !important; }

  /* Shading overlay labels — smaller on mobile */
  .shading-overlay-label { font-size: 8px !important; padding: 3px 5px !important; }

  /* Mobile stacking (from bottom up):
     0–46px  → toolbar
     56px+   → model badge / transform panel
     90px+   → toast / stats  */

  /* Mobile model bar removed — sidebar handles model selection */
  .mobile-model-bar { display: none !important; }
  .mobile-fab { display: none !important; }

  /* Model badge — just above toolbar */
  .model-badge { bottom: 56px !important; }
  /* Hide keyboard shortcut hints on mobile — no keyboard */
  .badge-hint { display: none !important; }

  /* Transform panel — just above toolbar */
  .transform-panel {
    bottom: 56px !important;
    left: 8px !important;
    min-width: 0 !important;
    width: calc(100vw - 16px) !important;
    max-width: 280px !important;
  }

  /* Toast — above model badge */
  .toast-msg { bottom: 90px !important; }

  /* Stats overlay — already top-right on desktop; mobile just trims padding/font */
  .scene-stats { top: 40px !important; bottom: auto !important; right: 8px !important; font-size: 9px !important; padding: 5px 10px !important; }

  /* Hide render-related UI on mobile — GPU can't handle it and it's desktop-only */
  .render-tab-btn { display: none !important; }
  .toolbar-render-btns { display: none !important; }
}

/* ── Small phones (iPhone SE, Pixel 5, 375px and under) ── */
@media (max-width: 380px) {
  .sidebar-panel { width: 100vw !important; max-width: 100vw !important; }
  .viewport-toolbar button { padding: 4px 6px !important; font-size: 9px !important; }
  .viewport-toolbar svg { width: 12px !important; height: 12px !important; }
  .mobile-model-bar { padding: 0 4px !important; }
  .shading-overlay-label { font-size: 7px !important; padding: 2px 4px !important; }
  .transform-panel { max-width: calc(100vw - 16px) !important; }
  .model-badge { font-size: 8px !important; }
}

/* ── Tablets (769px – 1024px) ── */
@media (min-width: 769px) and (max-width: 1024px) {
  .sidebar-panel { width: 220px !important; }
  .desktop-edge-tab { display: flex; }
  .burger-btn { display: none !important; }
  .sidebar-backdrop { display: none !important; }
}

/* ── Landscape mobile (short viewport) ── */
@media (max-height: 500px) and (orientation: landscape) {
  .mobile-model-bar { display: none !important; }
  .mobile-fab { display: none !important; }
  .render-tab-btn { display: none !important; }
  .toolbar-render-btns { display: none !important; }
  .viewport-toolbar { bottom: 4px !important; }
  .toast-msg { bottom: 50px !important; }
  .scene-stats { bottom: 55px !important; }
  .sidebar-panel { top: 32px !important; width: 240px !important; max-height: calc(100dvh - 32px) !important; overflow-y: auto !important; }
  .transform-panel { bottom: 50px !important; max-width: 220px !important; }
  .model-badge { bottom: 50px !important; }
  .shading-overlay-label { font-size: 8px !important; }
}

/* ── Full desktop (769px+) — ensure sidebar is never forced closed ── */
@media (min-width: 769px) {
  .sidebar-backdrop { display: none !important; }
  .mobile-model-bar { display: none !important; }
  .mobile-fab { display: none !important; }
  .mobile-nav-hint { display: none !important; }
  .nav-hint { display: flex !important; }
  .burger-btn { position: absolute !important; }
}

@keyframes slideIn { from { transform: translateX(-100%); } to { transform: translateX(0); } }
@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

/* Range input styling */
input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  background: rgba(255,255,255,0.06);
  border-radius: 2px;
  height: 2px;
  outline: none;
  touch-action: pan-x;
}
input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #6C63FF;
  cursor: pointer;
  border: none;
}
input[type="range"]::-moz-range-thumb {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #6C63FF;
  cursor: pointer;
  border: none;
}

/* Prevent text selection during touch interactions */
.viewport-toolbar, .transform-panel, .model-badge {
  -webkit-user-select: none;
  user-select: none;
}
